<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>消息发送端</title>
</head>

<body>
    <script>
        ; (function () {
            var messages = [
                "今天天气不错啊！！",
                "我都几年无去过中图了",
                "中国移动个饭堂常驻",
                "你老豆果套都算你嘎啦",
                "明天请假一天",
                "我落咗啦"
            ];

            var getMessage = function () {
                var index = Math.floor(Math.random() * 10)
                return messages[index] || null;
            }

            var postMessageLoop = function () {
                var randomTime = Math.floor(Math.random() * 10000);
                setTimeout(function () {
                    var message = getMessage();
                    if (message) {
                        window.parent.postMessage(message, "http://localhost:8080");
                    }

                    postMessageLoop();
                }, randomTime);
            }

            postMessageLoop();

        })();
    </script>
</body>

</html>